{{ define "main" }}

{{ $data := index .Site.Data .Site.Language.Lang }}
{{ $schedule := $data.schedule.schedule }}

{{ with $schedule }}
<section class="section-schedule section">
  <div class="container">
    <div class="row section-heading">
      <div class="col-12 col-lg-9">
        <div class="heading">
          <span class="stroke-text">{{ .title_outline }}</span>
          <div class="pl-90">
            <h2 class="mt-2">{{ .title | markdownify }}</h2>
          </div>
        </div>
      </div>
    </div>
  </div>
{{ end }}

<div class="container">
  <div class="row">
    <div class="col-lg-12">
      <nav class="nav nav-pills nav-fill" role="tablist">
      {{ $.Scratch.Set "counter" 0 }}
      {{ range $index, $element := $schedule.schedule_tab }}
        {{ $.Scratch.Set "counter" (add ($.Scratch.Get "counter") 1) }}
        <a class="nav-item nav-link {{ if eq $index 0 }} active {{ end }}" data-toggle="tab" href="#scheduleTab{{$.Scratch.Get `counter`}}"
            role="tab">
        <h2>{{ .title | markdownify }}</h2>
        <p>{{ .date_time | markdownify }}</p>
        </a>
      {{ end }}
      </nav>

      <div class="tab-content">
      {{ $.Scratch.Set "counter" 0 }}
      {{ range $index, $element := $schedule.schedule_tab }}
        {{ $.Scratch.Set "counter" (add ($.Scratch.Get "counter") 1) }}
        <div class="tab-pane fade {{ if eq $index 0 }} show active {{ end }} " id="scheduleTab{{$.Scratch.Get `counter`}}" role="tabpanel">
          <h3 class="mt-2">Temas del d√≠a: {{ .tracks }}</h3>
          <ul class="mt-4 time-table pl-0 list-unstyled">
            {{ range sort (where (where $.Site.Pages "Section" "sessions") ".Params.day_num" ($.Scratch.Get `counter`)) ".Params.time_start" }}
            <li class="d-md-flex align-items-center justify-content-between bg-light p-4 mb-3">
                <div class="time">
                <h4 class="text-color">
                {{ with .Params.time_start | time  }}
                  {{ $adjtime := .Unix | time }}
                  {{ $adjtime.Format "15:04" }}
                {{ end }}
                -
                {{ with .Params.time_end | time  }}
                  {{ $adjtime := .Unix | time }}
                  {{ $adjtime.Format "15:04" }}
                {{ end }}
                 </h4>
                 {{ partial "addcalendar.html" . }}
               </div>
                <div class="content">                
                <h3>
                <a href="{{ .Permalink }}">{{ .Params.title }}</a>
                </h3>
                {{ if .Params.speakers }}<h6 class="speakers-list">{{ i18n "by" }} {{ range .Params.speakers }} <span>{{ . }}</span> {{ end }} </h6>{{ end }}
              </div>
            </li>
            {{ end }}
          </ul>
        </div>
        {{ end }}
      </div>
      </div>
    </div>
  </div>
</section>

{{ end }}